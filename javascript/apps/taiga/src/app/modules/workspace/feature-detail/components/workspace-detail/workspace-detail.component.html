<!--
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.

Copyright (c) 2021-present Kaleidos Ventures SL
-->

<ng-container *ngIf="model$ | async as vm">
  <ng-container *transloco="let t">
    <ng-container *ngIf="vm.workspace">
      <div class="workspace-detail-top">
        <div class="workspace-detail-avatar">
          <tg-ui-avatar
            class="workspace-avatar"
            type="dark"
            [color]="vm.workspace.color"
            size="xl"
            [name]="vm.workspace.name">
          </tg-ui-avatar>
        </div>
        <div class="workspace-detail-title-wrapper">
          <div class="workspace-detail-title-route">Workspace/</div>
          <div class="workspace-detail-title-container">
            <h3 class="workspace-detail-title">{{ vm.workspace.name }}</h3>
            <tg-ui-badge
              *ngIf="vm.workspace.myRole"
              [label]="t('commons.roles.' + vm.workspace.myRole)"></tg-ui-badge>
            <tg-ui-badge
              *ngIf="vm.workspace.isOwner"
              [label]="t('commons.owner')"></tg-ui-badge>
          </div>
        </div>
        <div class="workspace-detail-actions">
          <a
            tuiButton
            type="button"
            appearance="tertiary"
            [routerLink]="['/']"
            iconRight="arrow-right">
            {{ t('workspace.back_to_projects') }}
          </a>
        </div>
      </div>
      <div
        *ngIf="
          (loading$ | async) === false &&
          !vm.workspace.totalProjects &&
          !vm.invitedProjects.length &&
          vm.workspace.hasProjects &&
          vm.workspace.myRole !== 'admin'
        "
        class="workspace-message-placeholder detail"
        [innerHtml]="t('workspace.placehoder_no_access')"></div>
      <div
        *ngIf="
          (loading$ | async) === false &&
          !vm.workspace.totalProjects &&
          !vm.invitedProjects.length &&
          !vm.workspace.hasProjects &&
          vm.workspace.myRole !== 'admin'
        "
        class="workspace-message-placeholder detail"
        [innerHtml]="t('workspace.placehoder_no_projects')"></div>
      <div
        (resized)="onResized($event)"
        [class]="gridClass"
        class="workspace-item-card-grid">
        <div
          *ngIf="vm.projects.length === 0 && vm.workspace.myRole === 'admin'">
          <tg-project-card
            [workspace]="vm.workspace"
            variant="placeholder"
            [firstProject]="true">
          </tg-project-card>
        </div>
        <div
          *ngFor="
            let invitedProject of vm.invitedProjects;
            trackBy: trackByLatestProject
          "
          @slideOut
          [@reorder]="reorder[invitedProject.slug]"
          (@reorder.done)="reorderDone($event)">
          <tg-project-card
            variant="invitation"
            (rejectInvite)="rejectProjectInvite($event)"
            (acceptInvite)="acceptProjectInvite($event)"
            [workspace]="vm.workspace"
            [project]="invitedProject">
          </tg-project-card>
        </div>
        <div
          *ngFor="let project of vm.projects; trackBy: trackByLatestProject"
          @slideOut
          [@reorder]="reorder[project.slug]"
          (@reorder.done)="reorderDone($event)">
          <tg-project-card [project]="project"> </tg-project-card>
        </div>
        <div *ngIf="vm.projects.length > 0 && vm.workspace.myRole === 'admin'">
          <tg-project-card
            [workspace]="vm.workspace"
            variant="placeholder">
          </tg-project-card>
        </div>
      </div>
    </ng-container>
  </ng-container>
</ng-container>
