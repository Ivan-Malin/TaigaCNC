{"version":3,"file":"taiga-ui-cdk-directives-media.js","sources":["ng://@taiga-ui/cdk/directives/media/media.directive.ts","ng://@taiga-ui/cdk/directives/media/media.module.ts","ng://@taiga-ui/cdk/directives/media/taiga-ui-cdk-directives-media.ts"],"sourcesContent":["import {\n    Directive,\n    ElementRef,\n    EventEmitter,\n    HostBinding,\n    HostListener,\n    Inject,\n    Input,\n    Output,\n} from '@angular/core';\nimport {tuiDefaultProp, tuiRequiredSetter} from '@taiga-ui/cdk/decorators';\n\nexport function nonNegativeFiniteAssertion(value: number): boolean {\n    return isFinite(value) && value >= 0;\n}\n\nexport function volumeAssertion(volume: number): boolean {\n    return isFinite(volume) && volume >= 0 && volume <= 1;\n}\n\n@Directive({\n    selector: 'video[tuiMedia], audio[tuiMedia]',\n    exportAs: 'tuiMedia',\n})\nexport class TuiMediaDirective {\n    @Input()\n    @HostBinding('volume')\n    @tuiDefaultProp(volumeAssertion)\n    volume = 1;\n\n    @Input('playbackRate')\n    @tuiRequiredSetter(nonNegativeFiniteAssertion)\n    set playbackRateSetter(playbackRate: number) {\n        this.updatePlaybackRate(playbackRate);\n    }\n\n    @Input()\n    @tuiRequiredSetter(nonNegativeFiniteAssertion)\n    set currentTime(currentTime: number) {\n        if (Math.abs(currentTime - this.currentTime) > 0.001) {\n            this.elementRef.nativeElement.currentTime = currentTime;\n        }\n    }\n\n    @Input()\n    set paused(paused: boolean) {\n        if (paused) {\n            this.elementRef.nativeElement.pause();\n        } else {\n            this.elementRef.nativeElement.play();\n            this.updatePlaybackRate(this.playbackRate);\n        }\n    }\n\n    @Output()\n    readonly currentTimeChange = new EventEmitter<number>();\n\n    @Output()\n    readonly pausedChange = new EventEmitter<boolean>();\n\n    @Output()\n    readonly volumeChange = new EventEmitter<number>();\n\n    private playbackRate = 1;\n\n    constructor(\n        @Inject(ElementRef)\n        private readonly elementRef: ElementRef<HTMLMediaElement>,\n    ) {}\n\n    get paused(): boolean {\n        return this.elementRef.nativeElement.paused;\n    }\n\n    get currentTime(): number {\n        return this.elementRef.nativeElement.currentTime;\n    }\n\n    // @bad TODO: Make sure no other events can affect this like network issues etc.\n    @HostListener('ended', ['true'])\n    @HostListener('pause', ['true'])\n    @HostListener('play', ['false'])\n    onPausedChange(paused: boolean) {\n        this.pausedChange.emit(paused);\n        this.updatePlaybackRate(this.playbackRate);\n    }\n\n    @HostListener('volumechange')\n    onVolumeChange() {\n        this.volume = this.elementRef.nativeElement.volume;\n        this.volumeChange.emit(this.volume);\n    }\n\n    @HostListener('timeupdate')\n    @HostListener('seeking')\n    @HostListener('seeked')\n    onCurrentTimeChange() {\n        this.currentTimeChange.emit(this.currentTime);\n    }\n\n    @HostListener('durationchange')\n    changeDetectionTrigger() {\n        // @bad TODO: consider if other events need to trigger CD\n    }\n\n    private updatePlaybackRate(playbackRate: number) {\n        this.playbackRate = playbackRate;\n        this.elementRef.nativeElement.playbackRate = this.playbackRate;\n    }\n}\n","import {NgModule} from '@angular/core';\nimport {TuiMediaDirective} from './media.directive';\n\n@NgModule({\n    declarations: [TuiMediaDirective],\n    exports: [TuiMediaDirective],\n})\nexport class TuiMediaModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}