!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@ng-web-apis/common"),require("@taiga-ui/cdk"),require("@taiga-ui/core/animations"),require("@taiga-ui/core/constants"),require("@taiga-ui/core/tokens"),require("@taiga-ui/core/utils/dom"),require("rxjs"),require("rxjs/operators"),require("@taiga-ui/core/components/scrollbar"),require("@taiga-ui/core/directives/mode"),require("@tinkoff/ng-polymorpheus")):"function"==typeof define&&define.amd?define("@taiga-ui/core/components/dropdown-box",["exports","@angular/core","@ng-web-apis/common","@taiga-ui/cdk","@taiga-ui/core/animations","@taiga-ui/core/constants","@taiga-ui/core/tokens","@taiga-ui/core/utils/dom","rxjs","rxjs/operators","@taiga-ui/core/components/scrollbar","@taiga-ui/core/directives/mode","@tinkoff/ng-polymorpheus"],e):e(((t=t||self)["taiga-ui"]=t["taiga-ui"]||{},t["taiga-ui"].core=t["taiga-ui"].core||{},t["taiga-ui"].core.components=t["taiga-ui"].core.components||{},t["taiga-ui"].core.components["dropdown-box"]={}),t.ng.core,t.common,t.cdk,t["taiga-ui"].core.animations,t["taiga-ui"].core.constants,t["taiga-ui"].core.tokens,t["taiga-ui"].core.utils.dom,t.rxjs,t.rxjs.operators,t["taiga-ui"].core.components.scrollbar,t["taiga-ui"].core.directives.mode,t.ngPolymorpheus)}(this,(function(t,e,i,o,n,r,a,s,c,l,d,u,h){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function p(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a}function f(t,e){return function(i,o){e(i,o,t)}}var g=function(){function t(t,e,i,n,r,a,s){var d=this;this.directive=i,this.windowRef=n,this.elementRef=r,this.portalHost=a,this.userAgent=s,this.prevDirectionIsTop=!1,c.merge(c.interval(o.POLLING_TIME),this.directive.refresh$,c.fromEvent(this.windowRef,"resize")).pipe(o.tuiZonefree(e),l.takeUntil(t)).subscribe((function(){d.calculatePositionAndSize()}))}return t.prototype.ngAfterViewChecked=function(){this.calculatePositionAndSize()},t.prototype.onTopFocus=function(){this.moveFocusOutside(!0)},t.prototype.onBottomFocus=function(){this.moveFocusOutside(!1)},Object.defineProperty(t.prototype,"overscroll",{get:function(){return this.inModal?"all":"scroll"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inModal",{get:function(){return!!o.getClosestElement(this.directive.host,"tui-dialog-host")},enumerable:!0,configurable:!0}),t.prototype.calculatePositionAndSize=function(){var t=this.directive.clientRect,e=this.elementRef.nativeElement.style,i=this.directive.fixed?this.portalHost.fixedPositionOffset():this.portalHost.clientRect;e.position=this.directive.fixed?"fixed":"absolute",this.calculateVerticalPosition(e,t,i),this.calculateHorizontalPosition(e,t,i),this.calculateWidth(e,t)},t.prototype.getFinalAlign=function(t,e){var i=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.offsetWidth,n=s.getScreenWidth(this.windowRef.document),r=e.left+o<n||e.right-o>0,a=i.right<=n&&i.left>=0,c=this.directive.align;switch(this.directive.align){case"left":r&&i.right>n&&(c="right");break;case"right":r&&i.left<0&&(c="left")}return"auto"===t.right&&a&&(c="left"),"auto"===t.left&&a&&(c="right"),c},t.prototype.calculateHorizontalPosition=function(t,e,i){var n=this.directive.sided?this.elementRef.nativeElement.getBoundingClientRect().width+r.DEFAULT_MARGIN:0,a=Math.ceil(e.left-i.left-n),s=Math.floor(i.right-e.right-n);switch(this.getFinalAlign(t,e)){case"left":s+r.DEFAULT_MARGIN>this.windowRef.innerWidth||o.inRange(a+r.DEFAULT_MARGIN,0,this.windowRef.innerWidth)?(t.left=o.px(a),t.right="auto"):(t.left="auto",t.right=o.px(s));break;case"right":o.inRange(s+r.DEFAULT_MARGIN,0,this.windowRef.innerWidth)||a+r.DEFAULT_MARGIN>this.windowRef.innerWidth?(t.left="auto",t.right=o.px(s)):(t.left=o.px(a),t.right="auto")}},t.prototype.calculateVerticalPosition=function(t,e,i){var n=this.windowRef.innerHeight,a=Math.min(this.directive.maxHeight,n-2*r.DEFAULT_MARGIN),s=this.directive.sided?r.DEFAULT_MARGIN-e.height:2*r.DEFAULT_MARGIN,c=e.top-s,l=n-e.bottom-s,d=this.getFinalDirection(e);this.prevDirectionIsTop="top"===d,"top"===d?(this.dropdownAnimation="fadeInBottom",t.maxHeight=o.px(Math.min(a,c)),t.top="auto",t.bottom=o.px(i.bottom-e.top-r.DEFAULT_MARGIN+s)):(this.dropdownAnimation="fadeInTop",t.maxHeight=o.px(Math.min(a,l)),t.top=o.px(e.bottom-i.top-r.DEFAULT_MARGIN+s),t.bottom="auto")},t.prototype.getFinalDirection=function(t){var e=this.windowRef.innerHeight,i=this.directive.sided?r.DEFAULT_MARGIN-t.height:2*r.DEFAULT_MARGIN,o=t.top-i,n=e-t.bottom-i,a=null;switch(this.directive.direction){case"top":o>=this.directive.minHeight&&(a="top");break;case"bottom":n>=this.directive.minHeight&&(a="bottom")}var s=Math.min(this.directive.maxHeight,e-2*r.DEFAULT_MARGIN);if(null===a&&this.contentElementRef){var c=Math.min(this.contentElementRef.nativeElement.getBoundingClientRect().height+(this.elementRef.nativeElement.offsetHeight-this.elementRef.nativeElement.clientHeight),s);a=this.prevDirectionIsTop&&o>=c?"top":n>=c||n>=o?"bottom":"top"}return a},t.prototype.calculateWidth=function(t,e){if(t.width="fixed"!==this.directive.limitMinWidth||this.directive.sided?"":o.px(e.width),!o.isIE(this.userAgent)||"min"!==this.directive.limitMinWidth||this.directive.sided){if("min"===this.directive.limitMinWidth&&!this.directive.sided)return t.minWidth=o.px(e.width),void(t.maxWidth=o.px(r.DEFAULT_MAX_WIDTH));t.minWidth="",t.maxWidth=""}else t.width=o.px(r.DEFAULT_MAX_WIDTH)},t.prototype.moveFocusOutside=function(t){for(var e=this.directive.host,i=e.ownerDocument,n=i?i.body:e,r=o.getClosestKeyboardFocusable(e,t,n);null!==r&&e.contains(r);)r=o.getClosestKeyboardFocusable(r,t,n);null!==r&&o.setNativeFocused(r)},t.ctorParameters=function(){return[{type:o.TuiDestroyService,decorators:[{type:e.Inject,args:[o.TuiDestroyService]}]},{type:e.NgZone,decorators:[{type:e.Inject,args:[e.NgZone]}]},{type:void 0,decorators:[{type:e.Inject,args:[a.TUI_DROPDOWN_DIRECTIVE]}]},{type:Window,decorators:[{type:e.Inject,args:[i.WINDOW]}]},{type:e.ElementRef,decorators:[{type:e.Inject,args:[e.ElementRef]}]},{type:o.TuiPortalHostComponent,decorators:[{type:e.Inject,args:[o.TuiPortalHostComponent]}]},{type:String,decorators:[{type:e.Inject,args:[i.USER_AGENT]}]}]},p([e.HostBinding("@tuiDropdownAnimation")],t.prototype,"dropdownAnimation",void 0),p([e.ViewChild("content",{read:e.ElementRef})],t.prototype,"contentElementRef",void 0),p([o.tuiPure],t.prototype,"inModal",null),t=p([e.Component({selector:"tui-dropdown-box",template:'<div\n    class="wrapper"\n    [tuiOverscroll]="overscroll"\n    [tuiMode]="null"\n    [tuiActiveZoneParent]="directive.activeZone"\n>\n    <tui-scrollbar class="scroll">\n        <div tabindex="0" (focus)="onTopFocus()"></div>\n        <div\n            polymorpheus-outlet\n            #content\n            class="content"\n            [content]="directive.content"\n        ></div>\n        <div tabindex="0" (focus)="onBottomFocus()"></div>\n    </tui-scrollbar>\n</div>\n',changeDetection:e.ChangeDetectionStrategy.Default,providers:[o.TuiDestroyService],animations:[n.tuiDropdownAnimation],styles:[":host{z-index:0;box-shadow:0 8px 16px rgba(51,51,51,.2);position:absolute;top:0;left:0;display:flex;background-color:#fff;background-color:var(--tui-base-01);border-radius:var(--tui-radius-m);overflow:hidden;border:1px solid var(--tui-base-03);box-sizing:border-box}:host.ng-animating{pointer-events:none}.content{display:flex;flex-direction:column;max-height:100%}.wrapper{flex-grow:1;max-width:100%;max-height:inherit;overflow:visible}.scroll{height:100%}"]}),f(0,e.Inject(o.TuiDestroyService)),f(1,e.Inject(e.NgZone)),f(2,e.Inject(a.TUI_DROPDOWN_DIRECTIVE)),f(3,e.Inject(i.WINDOW)),f(4,e.Inject(e.ElementRef)),f(5,e.Inject(o.TuiPortalHostComponent)),f(6,e.Inject(i.USER_AGENT))],t)}(),m=function(){function t(){}return t=p([e.NgModule({imports:[o.TuiActiveZoneModule,h.PolymorpheusModule,o.TuiOverscrollModule,d.TuiScrollbarModule,u.TuiModeModule],entryComponents:[g],declarations:[g],exports:[g]})],t)}();t.TuiDropdownBoxComponent=g,t.TuiDropdownBoxModule=m,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-core-components-dropdown-box.umd.min.js.map