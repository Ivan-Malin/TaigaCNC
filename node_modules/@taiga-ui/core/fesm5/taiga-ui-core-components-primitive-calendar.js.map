{"version":3,"file":"taiga-ui-core-components-primitive-calendar.js","sources":["ng://@taiga-ui/core/components/primitive-calendar/primitive-calendar.component.ts","ng://@taiga-ui/core/components/primitive-calendar/primitive-calendar.module.ts","ng://@taiga-ui/core/components/primitive-calendar/taiga-ui-core-components-primitive-calendar.ts"],"sourcesContent":["import {\n    ChangeDetectionStrategy,\n    Component,\n    EventEmitter,\n    HostBinding,\n    Inject,\n    Input,\n    Output,\n} from '@angular/core';\nimport {\n    ALWAYS_FALSE_HANDLER,\n    DAYS_IN_WEEK,\n    nullableSame,\n    TuiBooleanHandler,\n    TuiDay,\n    TuiDayRange,\n    tuiDefaultProp,\n    TuiMonth,\n    tuiRequiredSetter,\n} from '@taiga-ui/cdk';\nimport {TUI_DEFAULT_MARKER_HANDLER} from '@taiga-ui/core/constants';\nimport {TuiInteractiveState, TuiRangeState} from '@taiga-ui/core/enums';\nimport {TUI_SHORT_WEEK_DAYS} from '@taiga-ui/core/tokens';\nimport {TuiColor, TuiMarkerHandler} from '@taiga-ui/core/types';\nimport {Observable} from 'rxjs';\n\nconst ROWS_COUNT = 6;\n\n// @dynamic\n@Component({\n    selector: 'tui-primitive-calendar',\n    templateUrl: './primitive-calendar.template.html',\n    styleUrls: ['./primitive-calendar.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TuiPrimitiveCalendarComponent {\n    @Input()\n    @tuiDefaultProp()\n    disabledItemHandler: TuiBooleanHandler<TuiDay> = ALWAYS_FALSE_HANDLER;\n\n    @Input()\n    @tuiDefaultProp()\n    markerHandler: TuiMarkerHandler = TUI_DEFAULT_MARKER_HANDLER;\n\n    @Input()\n    @tuiDefaultProp()\n    value: TuiDayRange | TuiDay | null = null;\n\n    @Input()\n    @tuiDefaultProp()\n    hoveredItem: TuiDay | null = null;\n\n    @Input()\n    @tuiDefaultProp()\n    showAdjacent = true;\n\n    @Input()\n    @tuiRequiredSetter()\n    set month(month: TuiMonth) {\n        if (this.currentMonth !== null && this.currentMonth.monthSame(month)) {\n            return;\n        }\n\n        const sheet: Array<ReadonlyArray<TuiDay>> = [];\n\n        for (let rowIndex = 0; rowIndex < ROWS_COUNT; rowIndex++) {\n            const row: Array<TuiDay> = [];\n\n            for (let colIndex = 0; colIndex < DAYS_IN_WEEK; colIndex++) {\n                row.push(TuiDay.getDayFromMonthRowCol(month, rowIndex, colIndex));\n            }\n\n            sheet.push(row);\n        }\n\n        this.sheet = sheet;\n        this.currentMonth = month;\n    }\n\n    @Output()\n    readonly hoveredItemChange = new EventEmitter<TuiDay | null>();\n\n    @Output()\n    readonly dayClick = new EventEmitter<TuiDay>();\n\n    sheet: ReadonlyArray<ReadonlyArray<TuiDay>> = [];\n\n    private pressedItem: TuiDay | null = null;\n\n    private currentMonth: TuiMonth | null = null;\n\n    private today = TuiDay.currentLocal();\n\n    readonly toMarkers = (\n        day: TuiDay,\n        today: boolean,\n        inRange: boolean,\n    ): null | [TuiColor | string] | [TuiColor | string, TuiColor | string] => {\n        if (today || inRange) {\n            return null;\n        }\n\n        const markers = this.markerHandler(day);\n\n        return markers.length === 0 ? null : markers;\n    };\n\n    constructor(\n        @Inject(TUI_SHORT_WEEK_DAYS)\n        readonly weekDays$: Observable<\n            [string, string, string, string, string, string, string]\n        >,\n    ) {}\n\n    @HostBinding('class._single')\n    get isSingle(): boolean {\n        return (\n            this.value !== null &&\n            (this.value instanceof TuiDay || this.value.isSingleDay)\n        );\n    }\n\n    getItemState(item: TuiDay): TuiInteractiveState | null {\n        const {disabledItemHandler, pressedItem, hoveredItem} = this;\n\n        if (disabledItemHandler(item)) {\n            return TuiInteractiveState.Disabled;\n        }\n\n        if (pressedItem !== null && pressedItem.daySame(item)) {\n            return TuiInteractiveState.Pressed;\n        }\n\n        if (hoveredItem !== null && hoveredItem.daySame(item)) {\n            return TuiInteractiveState.Hovered;\n        }\n\n        return null;\n    }\n\n    getItemRange(item: TuiDay): TuiRangeState | null {\n        const {value, hoveredItem} = this;\n\n        if (value === null) {\n            return null;\n        }\n\n        if (value instanceof TuiDay) {\n            return value.daySame(item) ? TuiRangeState.Single : null;\n        }\n\n        if (\n            (value.from.daySame(item) && !value.isSingleDay) ||\n            (hoveredItem !== null &&\n                hoveredItem.dayAfter(value.from) &&\n                value.from.daySame(item) &&\n                value.isSingleDay) ||\n            (hoveredItem !== null &&\n                hoveredItem.daySame(item) &&\n                hoveredItem.dayBefore(value.from) &&\n                value.isSingleDay)\n        ) {\n            return TuiRangeState.Start;\n        }\n\n        if (\n            (value.to.daySame(item) && !value.isSingleDay) ||\n            (hoveredItem !== null &&\n                hoveredItem.dayBefore(value.from) &&\n                value.from.daySame(item) &&\n                value.isSingleDay) ||\n            (hoveredItem !== null &&\n                hoveredItem.daySame(item) &&\n                hoveredItem.dayAfter(value.from) &&\n                value.isSingleDay)\n        ) {\n            return TuiRangeState.End;\n        }\n\n        return value.isSingleDay && value.from.daySame(item)\n            ? TuiRangeState.Single\n            : null;\n    }\n\n    itemIsDisabled(day: TuiDay): boolean {\n        const {disabledItemHandler} = this;\n\n        return disabledItemHandler(day);\n    }\n\n    itemIsToday(item: TuiDay): boolean {\n        return this.today.daySame(item);\n    }\n\n    itemIsUnavailable(item: TuiDay): boolean {\n        return this.currentMonth === null || !this.currentMonth.monthSame(item);\n    }\n\n    itemIsInterval(day: TuiDay): boolean {\n        const {value, hoveredItem} = this;\n\n        if (value === null || value instanceof TuiDay) {\n            return false;\n        }\n\n        if (!value.isSingleDay) {\n            return value.from.daySameOrBefore(day) && value.to.dayAfter(day);\n        }\n\n        if (hoveredItem === null) {\n            return false;\n        }\n\n        const range = TuiDayRange.sort(value.from, hoveredItem);\n\n        return range.from.daySameOrBefore(day) && range.to.dayAfter(day);\n    }\n\n    onItemHovered(hovered: boolean, item: TuiDay) {\n        this.updateHoveredItem(hovered ? item : null);\n    }\n\n    onItemPressed(pressed: boolean, item: TuiDay) {\n        this.updatePressedItem(pressed, item);\n    }\n\n    onItemClick(event: MouseEvent, item: TuiDay) {\n        if (this.disabledItemHandler(item)) {\n            return;\n        }\n\n        event.preventDefault();\n        this.dayClick.emit(item);\n    }\n\n    private updateHoveredItem(day: TuiDay | null) {\n        if (nullableSame(this.hoveredItem, day, (a, b) => a.daySame(b))) {\n            return;\n        }\n\n        this.hoveredItem = day;\n        this.hoveredItemChange.emit(day);\n    }\n\n    private updatePressedItem(pressed: boolean, item: TuiDay) {\n        this.pressedItem = pressed ? item : null;\n    }\n}\n","import {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {\n    TuiHoveredModule,\n    TuiLetModule,\n    TuiMapperPipeModule,\n    TuiPressedModule,\n    TuiRepeatTimesModule,\n} from '@taiga-ui/cdk';\nimport {TuiColorModule} from '@taiga-ui/core/directives/color';\n\nimport {TuiPrimitiveCalendarComponent} from './primitive-calendar.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        TuiLetModule,\n        TuiMapperPipeModule,\n        TuiRepeatTimesModule,\n        TuiHoveredModule,\n        TuiPressedModule,\n        TuiColorModule,\n    ],\n    declarations: [TuiPrimitiveCalendarComponent],\n    exports: [TuiPrimitiveCalendarComponent],\n})\nexport class TuiPrimitiveCalendarModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}