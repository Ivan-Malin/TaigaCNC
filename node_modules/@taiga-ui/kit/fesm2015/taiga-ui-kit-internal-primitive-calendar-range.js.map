{"version":3,"file":"taiga-ui-kit-internal-primitive-calendar-range.js","sources":["ng://@taiga-ui/kit/internal/primitive-calendar-range/primitive-calendar-range.component.ts","ng://@taiga-ui/kit/internal/primitive-calendar-range/primitive-calendar-range.module.ts","ng://@taiga-ui/kit/internal/primitive-calendar-range/taiga-ui-kit-internal-primitive-calendar-range.ts"],"sourcesContent":["import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    Inject,\n    Input,\n    OnInit,\n    Optional,\n    Output,\n} from '@angular/core';\nimport {\n    ALWAYS_FALSE_HANDLER,\n    TUI_FIRST_DAY,\n    TUI_LAST_DAY,\n    TuiBooleanHandler,\n    TuiDay,\n    TuiDayRange,\n    tuiDefaultProp,\n    TuiDestroyService,\n    TuiMapper,\n    TuiMonth,\n    watch,\n} from '@taiga-ui/cdk';\nimport {TUI_DEFAULT_MARKER_HANDLER, TuiMarkerHandler} from '@taiga-ui/core';\nimport {TUI_CALENDAR_DATA_STREAM} from '@taiga-ui/kit/tokens';\nimport {Observable} from 'rxjs';\nimport {takeUntil} from 'rxjs/operators';\n\n/**\n * @internal\n */\n@Component({\n    selector: 'tui-primitive-calendar-range',\n    templateUrl: './primitive-calendar-range.template.html',\n    styleUrls: ['./primitive-calendar-range.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    providers: [TuiDestroyService],\n})\nexport class TuiPrimitiveCalendarRangeComponent implements OnInit {\n    @Input()\n    @tuiDefaultProp()\n    disabledItemHandler: TuiBooleanHandler<TuiDay> = ALWAYS_FALSE_HANDLER;\n\n    @Input()\n    @tuiDefaultProp()\n    markerHandler: TuiMarkerHandler = TUI_DEFAULT_MARKER_HANDLER;\n\n    @Input()\n    @tuiDefaultProp()\n    defaultViewedMonthFirst = TuiMonth.currentLocal();\n\n    @Input()\n    @tuiDefaultProp()\n    defaultViewedMonthSecond = TuiMonth.currentLocal().append({month: 1});\n\n    @Input()\n    @tuiDefaultProp()\n    min = TUI_FIRST_DAY;\n\n    @Input()\n    @tuiDefaultProp()\n    max = TUI_LAST_DAY;\n\n    @Input()\n    @tuiDefaultProp()\n    value: TuiDayRange | null = null;\n\n    @Output()\n    readonly dayClick = new EventEmitter<TuiDay>();\n\n    hoveredItem: TuiDay | null = null;\n\n    monthOffset: TuiMapper<TuiMonth, TuiMonth> = (value, offset: number) =>\n        value.append({month: offset});\n\n    userViewedMonthFirst: TuiMonth = this.defaultViewedMonthFirst;\n    userViewedMonthSecond: TuiMonth = this.defaultViewedMonthSecond;\n\n    constructor(\n        @Inject(TUI_CALENDAR_DATA_STREAM)\n        @Optional()\n        valueChanges: Observable<TuiDayRange | null> | null,\n        @Inject(ChangeDetectorRef) changeDetectorRef: ChangeDetectorRef,\n        @Inject(TuiDestroyService) destroy$: TuiDestroyService,\n    ) {\n        if (!valueChanges) {\n            return;\n        }\n\n        valueChanges\n            .pipe(watch(changeDetectorRef), takeUntil(destroy$))\n            .subscribe(value => {\n                this.value = value;\n                this.updateViewedMonths();\n            });\n    }\n\n    get cappedUserViewedMonthSecond(): TuiMonth {\n        return this.userViewedMonthSecond.monthBefore(this.max)\n            ? this.userViewedMonthSecond\n            : this.max;\n    }\n\n    get cappedUserViewedMonthFirst(): TuiMonth {\n        return this.userViewedMonthFirst.monthSameOrBefore(this.userViewedMonthSecond)\n            ? this.userViewedMonthFirst\n            : this.userViewedMonthSecond;\n    }\n\n    ngOnInit() {\n        this.updateViewedMonths();\n    }\n\n    onSectionFirstViewedMonth(month: TuiMonth) {\n        this.userViewedMonthFirst = month;\n\n        if (this.userViewedMonthSecond.year < this.userViewedMonthFirst.year) {\n            this.userViewedMonthSecond = this.userViewedMonthSecond.append({\n                year: month.year - this.userViewedMonthSecond.year,\n            });\n        }\n    }\n\n    onSectionSecondViewedMonth(month: TuiMonth) {\n        this.userViewedMonthSecond = month;\n\n        if (this.userViewedMonthFirst.year > this.userViewedMonthSecond.year) {\n            this.userViewedMonthFirst = this.userViewedMonthFirst.append({\n                year: month.year - this.userViewedMonthFirst.year,\n            });\n        }\n    }\n\n    onDayClick(day: TuiDay) {\n        this.dayClick.emit(day);\n    }\n\n    private updateViewedMonths() {\n        this.userViewedMonthFirst =\n            this.value === null ? this.defaultViewedMonthFirst : this.value.from;\n        this.userViewedMonthSecond =\n            this.value === null ? this.defaultViewedMonthSecond : this.value.to;\n\n        if (this.userViewedMonthFirst.monthSame(this.userViewedMonthSecond)) {\n            this.userViewedMonthSecond = this.userViewedMonthSecond.append({month: 1});\n        }\n    }\n}\n","import {NgModule} from '@angular/core';\nimport {TuiMapperPipeModule} from '@taiga-ui/cdk';\nimport {TuiCalendarModule, TuiScrollbarModule} from '@taiga-ui/core';\nimport {TuiPrimitiveCalendarRangeComponent} from './primitive-calendar-range.component';\n\n/**\n * @internal\n */\n@NgModule({\n    imports: [TuiMapperPipeModule, TuiScrollbarModule, TuiCalendarModule],\n    declarations: [TuiPrimitiveCalendarRangeComponent],\n    exports: [TuiPrimitiveCalendarRangeComponent],\n})\nexport class TuiPrimitiveCalendarRangeModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}